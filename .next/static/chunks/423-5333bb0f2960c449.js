"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{4423:function(e,t,n){n.d(t,{$:function(){return I}});var a=n(7437),r=n(2265),l=n(9501),i=n(3590),s=n(1115),o=n(2381),d=n(279),c=n(3448),u=n(7053);let m=r.createContext({}),x=e=>{let{...t}=e;return(0,a.jsx)(m.Provider,{value:{name:t.name},children:(0,a.jsx)(l.Qr,{...t})})},p=()=>{let e=r.useContext(m),{getFieldState:t,formState:n}=(0,l.Gc)(),a=t(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");return{name:e.name,...a}};function b(e){let{children:t,className:n,form:r,...i}=e;return(0,a.jsx)(l.RV,{...r,children:(0,a.jsx)("form",{className:(0,c.cn)("space-y-6",n),autoComplete:"off",...i,children:t})})}function h(e){let{className:t,...n}=e;return(0,a.jsx)("div",{className:(0,c.cn)("mb-2 rounded-lg bg-gradient-to-r from-blue-50 via-pink-50 to-yellow-50 dark:from-zinc-800 dark:via-zinc-900 dark:to-zinc-800 p-3",t),...n})}function g(e){let{className:t,...n}=e;return(0,a.jsx)("label",{className:(0,c.cn)("block text-base font-semibold mb-1",t),...n})}function f(e){let{...t}=e,{error:n,name:r}=p();return(0,a.jsx)(u.g7,{id:r,"aria-invalid":!!n,...t})}function v(e){let{className:t,...n}=e,{error:r}=p(),l=r?String(null==r?void 0:r.message):n.children;return l?(0,a.jsx)("div",{className:(0,c.cn)("text-xs text-red-600 mt-1",t),...n,children:l}):null}f.displayName="AppFormControl",v.displayName="AppFormMessage";var j=n(1245),k=n(3340),y=n(3671),w=n(5978),N=n(6410);let z=["Mechanical","Electrical","Production","Quality","Other"],C=s.z.object({complaintId:s.z.string(),complaintDate:s.z.string(),machineName:s.z.string().min(1,"Machine name is required"),complaintDescription:s.z.string().min(1,"Description is required"),priority:s.z.enum(["Low","Medium","High"]),complaintStatus:s.z.enum(["Open","In Progress","Closed","Pending Parts"]).default("Open"),actionDate:s.z.string().nullable().default(null),maintenanceRemarks:s.z.string().nullable().default(null),initialInspectionDate:s.z.string().nullable().default(null),estimatedEndDate:s.z.string().nullable().default(null),finalizationDate:s.z.string().nullable().default(null),createdBy:s.z.string().email("Valid email required"),department:s.z.string().min(1,"Department is required"),assignedTo:s.z.enum(["Person A","Person B","Person C","Person D"]).default("Person A"),materialsUsed:s.z.array(s.z.object({name:s.z.string().min(1,"Material name required"),quantity:s.z.string().min(1,"Quantity required"),remarks:s.z.string().optional()})).default([]),history:s.z.array(s.z.object({action:s.z.string(),user:s.z.string(),timestamp:s.z.string()})).default([])});function I(e){let{onSuccess:t,complaint:n}=e,{currentUser:s,loading:c}=(0,j.a)(),{toast:u}=(0,k.p)(),[m,p]=(0,r.useState)(!1),[I,D]=(0,r.useState)((null==n?void 0:n.materialsUsed)||[{name:"",quantity:"",remarks:""}]),[S,F]=(0,r.useState)((null==n?void 0:n.department)||"Mechanical"),[P,A]=(0,r.useState)((null==n?void 0:n.history)||[]),[U,E]=(0,r.useState)((null==n?void 0:n.complaintId)||"");(0,r.useEffect)(()=>{console.log("[ComplaintForm] Render. currentUser:",s,"loading:",c)}),(0,r.useEffect)(()=>{(async function(){if(n)return;let e=(0,w.hJ)(N.db,"complaints"),t=(0,w.IO)(e,(0,w.Xo)("complaintId","desc"),(0,w.b9)(1)),a=await (0,w.PL)(t),r=1;if(!a.empty){let e=a.docs[0].data().complaintId,t=e&&e.match(/AIRTECH-(\d+)/);t&&(r=parseInt(t[1],10)+1)}let l="AIRTECH-".concat(String(r).padStart(2,"0"));E(l),R.setValue("complaintId",l)})()},[n]);let R=(0,l.cI)({resolver:(0,i.F)(C),defaultValues:{complaintId:(null==n?void 0:n.complaintId)||"",complaintDate:(null==n?void 0:n.complaintDate)||new Date().toISOString().split("T")[0],machineName:(null==n?void 0:n.machineName)||"",complaintDescription:(null==n?void 0:n.complaintDescription)||"",priority:(null==n?void 0:n.priority)||"Low",complaintStatus:(null==n?void 0:n.complaintStatus)||"Open",actionDate:(null==n?void 0:n.actionDate)||null,maintenanceRemarks:(null==n?void 0:n.maintenanceRemarks)||null,initialInspectionDate:(null==n?void 0:n.initialInspectionDate)||null,estimatedEndDate:(null==n?void 0:n.estimatedEndDate)||null,finalizationDate:(null==n?void 0:n.finalizationDate)||null,createdBy:(null==n?void 0:n.createdBy)||(null==s?void 0:s.email)||"",department:(null==n?void 0:n.department)||"",assignedTo:(null==n?void 0:n.assignedTo)||"Person A",materialsUsed:(null==n?void 0:n.materialsUsed)||[{name:"",quantity:"",remarks:""}],history:(null==n?void 0:n.history)||[]}}),q=async e=>{if(console.group("[ComplaintForm] onSubmit Debug"),console.log("currentUser:",s),console.log("form data:",e),!s||!s.email||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(s.email)){u({title:"Error",description:"You must be logged in with a valid email to submit a complaint.",variant:"destructive"}),console.warn("Submission blocked: invalid or missing user/email",s),console.groupEnd();return}p(!0);try{let a;let r=new Date().toISOString(),l=s.email,i=[];(i=n?[...Array.isArray(n.history)?n.history:[],{action:"Updated",user:l,timestamp:r}]:[{action:"Created",user:l,timestamp:r}])&&0!==i.length||(i=[{action:"Created",user:l,timestamp:r}]);let o={...e,assignedTo:e.assignedTo,createdBy:l,department:e.department,materialsUsed:I,history:i};if(console.log("Submitting payload:",o),a=(null==n?void 0:n.id)?await (0,y.Rw)(n.id,o):await (0,y.GH)(o),console.log("Submission result:",a),a.success)u({title:"Success",description:a.message}),R.reset(),t(),console.info("Complaint submitted successfully:",{payload:o,result:a,user:s,time:new Date().toISOString()});else{let e="object"==typeof a.error?JSON.stringify(a.error):a.error;u({title:"Error",description:e||a.message||"Submission failed",variant:"destructive"}),console.error("Backend error:",a.message,e)}}catch(e){console.error("Submission error:",e),u({title:"Error",description:(null==e?void 0:e.message)||"An unexpected error occurred",variant:"destructive"})}finally{p(!1),console.groupEnd()}};return c?(console.log("[ComplaintForm] AuthContext loading, not rendering form."),(0,a.jsx)("div",{className:"mb-4 p-4 bg-blue-100 text-blue-800 rounded text-center font-semibold animate-pulse",children:"Checking login status..."})):null==s?(console.warn("[ComplaintForm] currentUser is null, blocking form."),(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-100 text-red-800 rounded text-center font-semibold",children:"You must be logged in to submit a complaint."})):"viewer"===s.role?(console.warn("[ComplaintForm] currentUser.role is viewer, blocking form."),(0,a.jsx)("div",{className:"mb-4 p-4 bg-yellow-100 text-yellow-800 rounded text-center font-semibold",children:"You do not have permission to submit a complaint."})):(0,a.jsx)(b,{form:R,onSubmit:R.handleSubmit(q),children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto bg-white dark:bg-zinc-900 rounded-2xl shadow-lg p-8 border border-zinc-200 dark:border-zinc-800 mt-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-primary mb-6 text-center tracking-tight",children:"Complaint Form"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6 bg-gradient-to-r from-blue-50 via-pink-50 to-yellow-50 dark:from-zinc-800 dark:via-zinc-900 dark:to-zinc-800 rounded-xl p-6 mb-4",children:[(0,a.jsx)(x,{control:R.control,name:"complaintId",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-blue-700 dark:text-blue-300",children:"Complaint ID"}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{...t,id:t.name,name:t.name,readOnly:!0,className:"bg-blue-100 dark:bg-zinc-800 font-semibold text-blue-900 dark:text-blue-200"})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"complaintDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-pink-700 dark:text-pink-300",children:"Complaint Date"}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{type:"date",...t,id:t.name,name:t.name,className:"bg-pink-100 dark:bg-zinc-800 text-pink-900 dark:text-pink-200"})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"machineName",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-yellow-700 dark:text-yellow-300",children:"Machine Name"}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{...t,id:t.name,name:t.name,className:"bg-yellow-100 dark:bg-zinc-800 text-yellow-900 dark:text-yellow-200"})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"complaintDescription",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{className:"md:col-span-2",children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-purple-700 dark:text-purple-300",children:"Description"}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{...t,id:t.name,name:t.name,className:"bg-purple-100 dark:bg-zinc-800 text-purple-900 dark:text-purple-200"})}),(0,a.jsx)(v,{})]})}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)(x,{control:R.control,name:"priority",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-red-700 dark:text-red-300",children:"Priority"}),(0,a.jsx)(f,{children:(0,a.jsxs)("select",{...t,id:t.name,name:t.name,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white text-black",children:[(0,a.jsx)("option",{value:"Low",children:"Low"}),(0,a.jsx)("option",{value:"Medium",children:"Medium"}),(0,a.jsx)("option",{value:"High",children:"High"})]})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"complaintStatus",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-green-700 dark:text-green-300",children:"Status"}),(0,a.jsx)(f,{children:(0,a.jsxs)("select",{...t,id:t.name,name:t.name,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-green-400 bg-white text-black",required:!0,children:[(0,a.jsx)("option",{value:"Open",children:"Open"}),(0,a.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,a.jsx)("option",{value:"Closed",children:"Closed"}),(0,a.jsx)("option",{value:"Pending Parts",children:"Pending Parts"}),(0,a.jsx)("option",{value:"Pending",children:"Pending"}),(0,a.jsx)("option",{value:"Completed",children:"Completed"})]})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"actionDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsxs)(g,{htmlFor:t.name,children:["Action Date ",(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(Date when action was/will be taken)"})]}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{type:"date",...t,id:t.name,name:t.name,value:t.value||""})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"maintenanceRemarks",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,children:"Maintenance Remarks"}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{...t,id:t.name,name:t.name,value:t.value||""})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"initialInspectionDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsxs)(g,{htmlFor:t.name,children:["Initial Inspection Date ",(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(First check/inspection date)"})]}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{type:"date",...t,id:t.name,name:t.name,value:t.value||""})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"estimatedEndDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsxs)(g,{htmlFor:t.name,children:["Estimated End Date ",(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(Expected completion date)"})]}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{type:"date",...t,id:t.name,name:t.name,value:t.value||""})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"finalizationDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsxs)(g,{htmlFor:t.name,children:["Finalization Date ",(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"(Date when complaint was fully resolved)"})]}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{type:"date",...t,id:t.name,name:t.name,value:t.value||""})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"createdBy",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,children:"Created By (Email)"}),(0,a.jsx)(f,{children:(0,a.jsx)(d.I,{type:"email",...t,id:t.name,name:t.name,value:t.value||"",readOnly:!0})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"department",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{htmlFor:t.name,className:"text-indigo-700 dark:text-indigo-300",children:"Concerned Department"}),(0,a.jsx)(f,{children:(0,a.jsx)("select",{...t,id:t.name,name:t.name,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white text-black",required:!0,children:z.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})}),(0,a.jsx)(v,{})]})}}),(0,a.jsx)(x,{control:R.control,name:"assignedTo",render:e=>{let{field:t}=e;return(0,a.jsxs)(h,{children:[(0,a.jsx)(g,{className:"text-blue-700 dark:text-blue-300",children:"Assigned To"}),(0,a.jsx)(f,{children:(0,a.jsxs)("select",{...t,className:"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white text-black",children:[(0,a.jsx)("option",{value:"Person A",children:"Person A"}),(0,a.jsx)("option",{value:"Person B",children:"Person B"}),(0,a.jsx)("option",{value:"Person C",children:"Person C"}),(0,a.jsx)("option",{value:"Person D",children:"Person D"})]})}),(0,a.jsx)(v,{})]})}})]}),(0,a.jsxs)("div",{className:"md:col-span-2 mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-pink-700 dark:text-pink-300 mb-2",children:"Materials Used"}),(0,a.jsxs)("div",{className:"space-y-2",children:[I.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2 mb-2 items-center",children:[(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)("label",{htmlFor:"material-name-".concat(t),className:"block text-xs font-semibold mb-1",children:"Material Name"}),(0,a.jsx)(d.I,{id:"material-name-".concat(t),name:"materialsUsed.".concat(t,".name"),placeholder:"Material Name",value:e.name,onChange:e=>{let n=[...I];n[t].name=e.target.value,D(n),R.setValue("materialsUsed",n)},className:"bg-blue-50 dark:bg-zinc-800",required:!0})]}),(0,a.jsxs)("div",{className:"flex flex-col w-1/4",children:[(0,a.jsx)("label",{htmlFor:"material-quantity-".concat(t),className:"block text-xs font-semibold mb-1",children:"Quantity"}),(0,a.jsx)(d.I,{id:"material-quantity-".concat(t),name:"materialsUsed.".concat(t,".quantity"),placeholder:"Quantity",value:e.quantity,onChange:e=>{let n=[...I];n[t].quantity=e.target.value,D(n),R.setValue("materialsUsed",n)},className:"bg-yellow-50 dark:bg-zinc-800",required:!0})]}),(0,a.jsxs)("div",{className:"flex flex-col w-1/3",children:[(0,a.jsx)("label",{htmlFor:"material-remarks-".concat(t),className:"block text-xs font-semibold mb-1",children:"Remarks"}),(0,a.jsx)(d.I,{id:"material-remarks-".concat(t),name:"materialsUsed.".concat(t,".remarks"),placeholder:"Remarks",value:e.remarks||"",onChange:e=>{let n=[...I];n[t].remarks=e.target.value,D(n),R.setValue("materialsUsed",n)},className:"bg-pink-50 dark:bg-zinc-800"})]}),(0,a.jsx)(o.z,{type:"button",variant:"destructive",size:"sm",onClick:()=>{let e=I.filter((e,n)=>n!==t);D(e),R.setValue("materialsUsed",e)},disabled:1===I.length,children:"Remove"})]},t)),(0,a.jsx)(o.z,{type:"button",variant:"secondary",size:"sm",className:"bg-gradient-to-r from-blue-200 via-pink-200 to-yellow-200 dark:from-zinc-700 dark:via-zinc-800 dark:to-zinc-700 text-blue-900 dark:text-blue-200",onClick:()=>{let e=[...I,{name:"",quantity:"",remarks:""}];D(e),R.setValue("materialsUsed",e)},children:"+ Add Material"})]})]}),(0,a.jsxs)("div",{className:"md:col-span-2 mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mb-2",children:"Complaint History"}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 via-blue-50 to-pink-50 dark:from-zinc-800 dark:via-zinc-900 dark:to-zinc-800 rounded p-3 max-h-40 overflow-y-auto text-xs",children:0===P.length?(0,a.jsx)("div",{className:"text-gray-500",children:"No history yet."}):P.map((e,t)=>(0,a.jsxs)("div",{className:"mb-1",children:[(0,a.jsx)("span",{className:"font-semibold text-green-700 dark:text-green-300",children:e.action})," by ",(0,a.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:e.user})," on ",(0,a.jsx)("span",{className:"text-pink-700 dark:text-pink-300",children:new Date(e.timestamp).toLocaleString()})]},t))})]}),(0,a.jsx)("div",{className:"md:col-span-2 mt-8",children:(0,a.jsx)(o.z,{type:"submit",disabled:m||!(null==s?void 0:s.email),className:"w-full text-lg font-bold bg-gradient-to-r from-blue-500 via-pink-500 to-yellow-500 text-white shadow-lg hover:from-blue-600 hover:via-pink-600 hover:to-yellow-600",children:m?"Submitting...":n?"Update":"Submit"})})]})]})},(null==s?void 0:s.email)||"nouser")}},2381:function(e,t,n){n.d(t,{z:function(){return l}});var a=n(7437),r=n(3448);let l=n(2265).forwardRef((e,t)=>{let{className:n,variant:l="primary",size:i="md",...s}=e,o="";switch(l){case"primary":o="bg-gradient-to-r from-blue-500 via-pink-500 to-yellow-500 text-white shadow-lg rounded-lg hover:from-blue-600 hover:via-pink-600 hover:to-yellow-600";break;case"secondary":o="bg-gradient-to-r from-blue-200 via-pink-200 to-yellow-200 text-blue-900 dark:text-blue-200 rounded-lg hover:from-blue-300 hover:via-pink-300 hover:to-yellow-300";break;case"destructive":o="bg-red-600 text-white rounded-lg hover:bg-red-700";break;case"ghost":o="bg-transparent text-primary hover:bg-blue-50 dark:hover:bg-zinc-800 rounded-lg";break;case"outline":o="border border-blue-400 text-blue-700 dark:text-blue-300 bg-white dark:bg-zinc-900 rounded-lg hover:bg-blue-50 dark:hover:bg-zinc-800";break;default:o=""}let d="";switch(i){case"sm":d="px-3 py-1.5 text-sm";break;case"lg":d="px-6 py-3 text-lg";break;default:d="px-4 py-2 text-base"}return(0,a.jsx)("button",{ref:t,className:(0,r.cn)("inline-flex items-center justify-center font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",o,d,n),...s})});l.displayName="Button"},279:function(e,t,n){n.d(t,{I:function(){return i}});var a=n(7437),r=n(2265),l=n(3448);let i=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("input",{ref:t,className:(0,l.cn)("block w-full rounded-lg border border-blue-200 dark:border-zinc-700 bg-white dark:bg-zinc-900 px-4 py-2 text-base text-blue-900 dark:text-blue-200 placeholder:text-blue-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-150 shadow-sm","hover:border-pink-400 dark:hover:border-pink-400",n),...r})});i.displayName="Input"},1245:function(e,t,n){n.d(t,{AuthProvider:function(){return c},a:function(){return u}});var a=n(7437),r=n(2265),l=n(6410),i=n(3301),s=n(5978),o=n(3340);let d=(0,r.createContext)({currentUser:null,loading:!0,logout:async()=>{}});function c(e){let{children:t}=e,[n,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),{toast:x}=(0,o.p)();(0,r.useEffect)(()=>{let e=(0,i.Aj)(l.I,async e=>{if(console.log("[AuthContext] onAuthStateChanged:",e),e){var t,n;let a=(0,s.JU)(l.db,"users",e.uid),r=await (0,s.QT)(a),i=r.exists()?r.data():null;console.log("[AuthContext] Firestore userDoc:",i),c({uid:e.uid,email:e.email||(null==i?void 0:i.email)||null,role:null!==(t=null==i?void 0:i.role)&&void 0!==t?t:"viewer"}),console.log("[AuthContext] setCurrentUser:",{uid:e.uid,email:e.email||(null==i?void 0:i.email)||null,role:null!==(n=null==i?void 0:i.role)&&void 0!==n?n:"viewer"})}else c(null),console.log("[AuthContext] setCurrentUser: null");m(!1),console.log("[AuthContext] setLoading: false")});return()=>e()},[]);let p=async()=>{try{await (0,i.w7)(l.I),c(null),x({title:"Success",description:"Logged out successfully."})}catch(e){throw console.error("Logout error:",e),x({title:"Error",description:"Failed to log out.",variant:"destructive"}),e}};return(0,a.jsx)(d.Provider,{value:{currentUser:n,loading:u,logout:p},children:t})}function u(){return(0,r.useContext)(d)}},3340:function(e,t,n){n.d(t,{p:function(){return l}});var a=n(2265);(0,n(535).j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}});let r=0;function l(){let[e,t]=(0,a.useState)([]);return{toast:(0,a.useCallback)(e=>{let{variant:n,title:a,description:l,action:i,...s}=e,o=(r++).toString();return t(e=>[...e,{id:o,variant:n,title:a,description:l,action:i,...s}]),o},[]),dismiss:(0,a.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),update:(0,a.useCallback)((e,n)=>{let{variant:a,title:r,description:l,action:i,...s}=n;t(t=>t.map(t=>t.id===e?{...t,variant:a,title:r,description:l,action:i,...s}:t))},[]),toasts:e}}},3671:function(e,t,n){n.d(t,{GH:function(){return l},Rj:function(){return r},Rw:function(){return i}}),n(3079);var a=n(2119),r=(0,a.$)("998298903baf9762d143374f7ecff409772b57f2"),l=(0,a.$)("9d39176c87d5a55a2a801870066abbb60034d1e9"),i=(0,a.$)("636e37b96d51317ae5b1270212bc499e1fddb28b")},6410:function(e,t,n){n.d(t,{I:function(){return o},db:function(){return d}});var a=n(738),r=n(3301),l=n(5978),i=n(62);let s=(0,a.ZF)({apiKey:"AIzaSyDBgH3vn2ec1FwRRkVIG5gAR9Jkno5VCR4",authDomain:"maintenance-flow-1c30c.firebaseapp.com",projectId:"maintenance-flow-1c30c",storageBucket:"maintenance-flow-1c30c.appspot.com",messagingSenderId:"116876204407",appId:"1:116876204407:web:7641e3dbb7a48cd69c6972"}),o=(0,r.v0)(s),d=(0,l.ad)(s);(0,i.cF)(s)},3448:function(e,t,n){n.d(t,{cn:function(){return l}});var a=n(1994),r=n(3335);function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}}}]);